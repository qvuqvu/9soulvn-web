{"ast":null,"code":"import { USER_LOGIN_REQUEST, USER_LOGIN_SUCCESS, USER_LOGIN_FAILURE, USER_LOGIN_REFRESH_REQUEST, USER_LOGIN_REFRESH_SUCCESS, USER_LOGIN_REFRESH_FAILURE, USER_LOGOUT, USER_REGISTER_REQUEST, USER_REGISTER_SUCCESS, USER_REGISTER_FAILURE, USER_RESET_PASSWORD_REQUEST, USER_RESET_PASSWORD_SUCCESS, USER_RESET_PASSWORD_FAILURE, USER_EMAIL_VERIFICATION_REQUEST, USER_EMAIL_VERIFICATION_SUCCESS, USER_EMAIL_VERIFICATION_FAILURE, USER_CONFIRM_REQUEST, USER_CONFIRM_SUCCESS, USER_CONFIRM_FAILURE, USER_DETAILS_REQUEST, USER_DETAILS_SUCCESS, USER_DETAILS_FAILURE, USER_DETAILS_RESET, USER_PROFILE_UPDATE_REQUEST, USER_PROFILE_UPDATE_SUCCESS, USER_PROFILE_UPDATE_FAILURE, USER_LIST_REQUEST, USER_LIST_SUCCESS, USER_LIST_FAILURE, USER_DELETE_REQUEST, USER_DELETE_SUCCESS, USER_DELETE_FAILURE, USER_UPDATE_REQUEST, USER_UPDATE_SUCCESS, USER_UPDATE_FAILURE } from '../constants/userConstants';\nimport { ORDER_CREATE_RESET, ORDER_USER_LIST_RESET } from '../constants/orderConstants';\nimport axios from 'axios'; // login an user, can be a social login or a normal email verified login\n\nexport const loginUser = (email, password) => async dispatch => {\n  try {\n    dispatch({\n      type: USER_LOGIN_REQUEST\n    });\n    const config = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    };\n    const {\n      data\n    } = await axios.post('/api/users/login', {\n      email,\n      password\n    }, config);\n    dispatch({\n      type: USER_LOGIN_SUCCESS,\n      payload: { ...data,\n        isSocialLogin: false\n      }\n    });\n    dispatch({\n      type: USER_LOGIN_REFRESH_SUCCESS,\n      payload: data.refreshToken\n    }); // store the refresh token and the rest of the user info in the local storage\n\n    localStorage.setItem('refreshToken', data.refreshToken);\n    localStorage.setItem('userInfo', JSON.stringify({ ...data,\n      isSocialLogin: false\n    })); // remove the variable that helps prompt the user that email is not verified, each time they login\n\n    localStorage.removeItem('promptEmailVerfication');\n  } catch (error) {\n    dispatch({\n      type: USER_LOGIN_FAILURE,\n      payload: error.response && error.response.data.message ? error.response.data.message : error.message\n    });\n  }\n}; // used for refreshing the access tokens when the user logs in using email and password\n\nexport const refreshLogin = email => async (dispatch, getState) => {\n  try {\n    dispatch({\n      type: USER_LOGIN_REFRESH_REQUEST\n    });\n    const {\n      userLogin: {\n        userInfo\n      }\n    } = getState(); // avoid this if social login\n\n    if (userInfo.isSocialLogin) {\n      dispatch({\n        type: USER_LOGIN_REFRESH_SUCCESS,\n        payload: null\n      });\n    } else {\n      const config = {\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      };\n      const {\n        data\n      } = await axios.post('/api/users/refresh', {\n        email,\n        token: userInfo.refreshToken\n      }, config);\n\n      if (data.success) {\n        dispatch({\n          type: USER_LOGIN_REFRESH_SUCCESS,\n          payload: data\n        });\n        const updatedUser = { ...userInfo,\n          accessToken: data.accessToken,\n          refreshToken: userInfo.refreshToken\n        }; // update the local storage\n\n        localStorage.setItem('userInfo', JSON.stringify(updatedUser));\n        dispatch({\n          type: USER_LOGIN_SUCCESS,\n          payload: updatedUser\n        });\n      } else if (!data.success) {\n        // set a variable in local storage which redirects to login page, if this refresh thing fails\n        localStorage.removeItem('userInfo');\n        localStorage.setItem('redirectLogin', 'true'); // after refresh token also expires, redirect to login page after loggin out the user\n\n        dispatch({\n          type: USER_LOGOUT\n        });\n      }\n    }\n  } catch (error) {\n    dispatch({\n      type: USER_LOGIN_REFRESH_FAILURE,\n      payload: error.response && error.response.data.message ? error.response.data.message : error.message\n    });\n  }\n}; // logout by removing all local storage info\n\nexport const logoutUser = () => dispatch => {\n  localStorage.removeItem('userInfo');\n  localStorage.removeItem('redirectLogin');\n  localStorage.removeItem('cartItems');\n  dispatch({\n    type: USER_LOGOUT\n  });\n  dispatch({\n    type: USER_DETAILS_RESET\n  });\n  dispatch({\n    type: ORDER_CREATE_RESET\n  });\n  dispatch({\n    type: ORDER_USER_LIST_RESET\n  });\n}; // register a new user with the form for name, email, password\n\nexport const registerUser = (name, email, password) => async dispatch => {\n  try {\n    dispatch({\n      type: USER_REGISTER_REQUEST\n    });\n    const config = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    };\n    const {\n      data\n    } = await axios.post('/api/users/', {\n      name,\n      email,\n      password\n    }, config);\n    dispatch({\n      type: USER_REGISTER_SUCCESS,\n      payload: data\n    });\n  } catch (error) {\n    dispatch({\n      type: USER_REGISTER_FAILURE,\n      payload: error.response && error.response.data.message ? error.response.data.message : error.message\n    });\n  }\n}; // send an email for verification of the newly registered account\n\nexport const sendVerficationEmail = email => async dispatch => {\n  try {\n    dispatch({\n      type: USER_EMAIL_VERIFICATION_REQUEST\n    });\n    const config = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    };\n    const {\n      data\n    } = await axios.post('/api/users/confirm', {\n      email\n    }, config);\n    dispatch({\n      type: USER_EMAIL_VERIFICATION_SUCCESS,\n      payload: data\n    });\n  } catch (error) {\n    dispatch({\n      type: USER_EMAIL_VERIFICATION_FAILURE,\n      payload: error.response && error.response.data.message ? error.response.data.message : error.message\n    });\n  }\n}; // take the email token sent from the mail, and confirm the account once the link is clicked\n\nexport const confirmUser = function (emailToken) {\n  let alreadyLoggedIn = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  return async (dispatch, getState) => {\n    try {\n      dispatch({\n        type: USER_CONFIRM_REQUEST\n      });\n      const {\n        data\n      } = await axios.get(`/api/users/confirm/${emailToken}`); // remove variable meant to prompt the user for email verification\n\n      localStorage.removeItem('promptEmailVerfication');\n      dispatch({\n        type: USER_CONFIRM_SUCCESS,\n        payload: true\n      });\n\n      if (alreadyLoggedIn) {\n        dispatch({\n          type: USER_LOGIN_SUCCESS,\n          payload: data\n        });\n        dispatch({\n          type: USER_LOGIN_REFRESH_SUCCESS,\n          payload: data.refreshToken\n        });\n        localStorage.setItem('refreshToken', data.refreshToken);\n        localStorage.setItem('userInfo', JSON.stringify(data));\n      }\n\n      localStorage.removeItem('promptEmailVerfication');\n    } catch (error) {\n      dispatch({\n        type: USER_CONFIRM_FAILURE,\n        payload: error.response && error.response.data.message ? error.response.data.message : error.message\n      });\n    }\n  };\n}; // reset the user password and send one more verification email from the server\n\nexport const resetUserPassword = (passwordToken, password) => async dispatch => {\n  try {\n    dispatch({\n      type: USER_RESET_PASSWORD_REQUEST\n    }); // make the api call to reset the password\n\n    const config = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    };\n    const {\n      data\n    } = await axios.put('/api/users/reset', {\n      passwordToken,\n      password\n    }, config);\n    dispatch({\n      type: USER_RESET_PASSWORD_SUCCESS,\n      payload: data\n    });\n  } catch (error) {\n    dispatch({\n      type: USER_RESET_PASSWORD_FAILURE,\n      payload: error.response && error.response.data.message ? error.response.data.message : error.message\n    });\n  }\n}; // get user details for profile page\n\nexport const getUserDetails = id => async (dispatch, getState) => {\n  try {\n    dispatch({\n      type: USER_DETAILS_REQUEST\n    });\n    const {\n      userLogin: {\n        userInfo\n      }\n    } = getState();\n\n    if (userInfo.isSocialLogin) {\n      const config = {\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      };\n      let {\n        data\n      } = await axios.post('/api/users/passport/data/', {\n        id\n      }, config);\n      dispatch({\n        type: USER_DETAILS_SUCCESS,\n        payload: { ...data,\n          isSocialLogin: true\n        }\n      });\n    } else {\n      const config = {\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${userInfo.accessToken}`\n        }\n      };\n      const {\n        data\n      } = await axios.get(`/api/users/${id}`, config);\n      dispatch({\n        type: USER_DETAILS_SUCCESS,\n        payload: { ...data,\n          isSocialLogin: false\n        }\n      });\n    }\n  } catch (error) {\n    dispatch({\n      type: USER_DETAILS_FAILURE,\n      payload: error.response && error.response.data.message ? error.response.data.message : error.message\n    });\n  }\n}; // update details in the user profile page\n\nexport const updateUserProfile = user => async (dispatch, getState) => {\n  try {\n    dispatch({\n      type: USER_PROFILE_UPDATE_REQUEST\n    });\n    const {\n      userLogin: {\n        userInfo\n      }\n    } = getState(); // different headers are used when it is a social login, and when it is a std email login\n\n    const config = userInfo.isSocialLogin ? {\n      headers: {\n        Authorization: `SocialLogin ${userInfo.id}`\n      }\n    } : {\n      headers: {\n        Authorization: `Bearer ${userInfo.accessToken}`\n      }\n    };\n    const isSocial = userInfo.isSocialLogin;\n    const {\n      data\n    } = await axios.put('/api/users/profile', user, config);\n    dispatch({\n      type: USER_PROFILE_UPDATE_SUCCESS,\n      payload: { ...data,\n        isSocialLogin: isSocial\n      }\n    }); // login the user after updating the information\n\n    dispatch({\n      type: USER_LOGIN_SUCCESS,\n      payload: { ...data,\n        isSocialLogin: isSocial\n      }\n    });\n    localStorage.setItem('userInfo', JSON.stringify({ ...data,\n      isSocialLogin: isSocial\n    }));\n  } catch (error) {\n    dispatch({\n      type: USER_PROFILE_UPDATE_FAILURE,\n      payload: error.response && error.response.data.message ? error.response.data.message : error.message\n    });\n  }\n}; // fetch a list of all users, for the admin panel view\n\nexport const listAllUsers = function () {\n  let pageNumber = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  return async (dispatch, getState) => {\n    try {\n      dispatch({\n        type: USER_LIST_REQUEST\n      });\n      const {\n        userLogin: {\n          userInfo\n        }\n      } = getState(); // different headers are used when it is a social login, and when it is a std email login\n\n      const config = userInfo.isSocialLogin ? {\n        headers: {\n          Authorization: `SocialLogin ${userInfo.id}`\n        }\n      } : {\n        headers: {\n          Authorization: `Bearer ${userInfo.accessToken}`\n        }\n      };\n      const {\n        data\n      } = await axios.get(`/api/users?pageNumber=${pageNumber}`, config);\n      dispatch({\n        type: USER_LIST_SUCCESS,\n        payload: data\n      });\n    } catch (error) {\n      dispatch({\n        type: USER_LIST_FAILURE,\n        payload: error.response && error.response.data.message ? error.response.data.message : error.message\n      });\n    }\n  };\n}; // delete the user from the admin panel view\n\nexport const deleteUser = id => async (dispatch, getState) => {\n  try {\n    dispatch({\n      type: USER_DELETE_REQUEST\n    });\n    const {\n      userLogin: {\n        userInfo\n      }\n    } = getState(); // different headers are used when it is a social login, and when it is a std email login\n\n    const config = userInfo.isSocialLogin ? {\n      headers: {\n        Authorization: `SocialLogin ${userInfo.id}`\n      }\n    } : {\n      headers: {\n        Authorization: `Bearer ${userInfo.accessToken}`\n      }\n    };\n    await axios.delete(`/api/users/${id}`, config);\n    dispatch({\n      type: USER_DELETE_SUCCESS\n    });\n  } catch (error) {\n    dispatch({\n      type: USER_DELETE_FAILURE,\n      payload: error.response && error.response.data.message ? error.response.data.message : error.message\n    });\n  }\n}; // update the user details\n\nexport const updateUser = user => async (dispatch, getState) => {\n  try {\n    dispatch({\n      type: USER_UPDATE_REQUEST\n    });\n    const {\n      userLogin: {\n        userInfo\n      }\n    } = getState();\n    const config = userInfo.isSocialLogin ? {\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `SocialLogin ${userInfo.id}`\n      }\n    } : {\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${userInfo.accessToken}`\n      }\n    };\n    const isSocial = userInfo.isSocialLogin;\n    const {\n      data\n    } = await axios.put(`/api/users/${user._id}`, user, config);\n    dispatch({\n      type: USER_UPDATE_SUCCESS\n    });\n    dispatch({\n      type: USER_DETAILS_SUCCESS,\n      payload: { ...data,\n        isSocialLogin: isSocial\n      }\n    });\n\n    if (data.id === userInfo.id) {\n      // // login the user after updating the information\n      const newUserInfo = { ...userInfo,\n        ...userInfo,\n        id: data.id,\n        name: data.name,\n        email: data.email,\n        isAdmin: data.isAdmin,\n        isConfirmed: data.isConfirmed\n      };\n      dispatch({\n        type: USER_LOGIN_SUCCESS,\n        payload: newUserInfo\n      });\n      localStorage.setItem('userInfo', JSON.stringify(newUserInfo));\n    }\n  } catch (error) {\n    dispatch({\n      type: USER_UPDATE_FAILURE,\n      payload: error.response && error.response.data.message ? error.response.data.message : error.message\n    });\n  }\n};","map":{"version":3,"names":["USER_LOGIN_REQUEST","USER_LOGIN_SUCCESS","USER_LOGIN_FAILURE","USER_LOGIN_REFRESH_REQUEST","USER_LOGIN_REFRESH_SUCCESS","USER_LOGIN_REFRESH_FAILURE","USER_LOGOUT","USER_REGISTER_REQUEST","USER_REGISTER_SUCCESS","USER_REGISTER_FAILURE","USER_RESET_PASSWORD_REQUEST","USER_RESET_PASSWORD_SUCCESS","USER_RESET_PASSWORD_FAILURE","USER_EMAIL_VERIFICATION_REQUEST","USER_EMAIL_VERIFICATION_SUCCESS","USER_EMAIL_VERIFICATION_FAILURE","USER_CONFIRM_REQUEST","USER_CONFIRM_SUCCESS","USER_CONFIRM_FAILURE","USER_DETAILS_REQUEST","USER_DETAILS_SUCCESS","USER_DETAILS_FAILURE","USER_DETAILS_RESET","USER_PROFILE_UPDATE_REQUEST","USER_PROFILE_UPDATE_SUCCESS","USER_PROFILE_UPDATE_FAILURE","USER_LIST_REQUEST","USER_LIST_SUCCESS","USER_LIST_FAILURE","USER_DELETE_REQUEST","USER_DELETE_SUCCESS","USER_DELETE_FAILURE","USER_UPDATE_REQUEST","USER_UPDATE_SUCCESS","USER_UPDATE_FAILURE","ORDER_CREATE_RESET","ORDER_USER_LIST_RESET","axios","loginUser","email","password","dispatch","type","config","headers","data","post","payload","isSocialLogin","refreshToken","localStorage","setItem","JSON","stringify","removeItem","error","response","message","refreshLogin","getState","userLogin","userInfo","token","success","updatedUser","accessToken","logoutUser","registerUser","name","sendVerficationEmail","confirmUser","emailToken","alreadyLoggedIn","get","resetUserPassword","passwordToken","put","getUserDetails","id","Authorization","updateUserProfile","user","isSocial","listAllUsers","pageNumber","deleteUser","delete","updateUser","_id","newUserInfo","isAdmin","isConfirmed"],"sources":["C:/Users/qvuqv/OneDrive/Documents/UIT/ecom2/MERN-Ecommerce/frontend/src/actions/userActions.js"],"sourcesContent":["import {\r\n\tUSER_LOGIN_REQUEST,\r\n\tUSER_LOGIN_SUCCESS,\r\n\tUSER_LOGIN_FAILURE,\r\n\tUSER_LOGIN_REFRESH_REQUEST,\r\n\tUSER_LOGIN_REFRESH_SUCCESS,\r\n\tUSER_LOGIN_REFRESH_FAILURE,\r\n\tUSER_LOGOUT,\r\n\tUSER_REGISTER_REQUEST,\r\n\tUSER_REGISTER_SUCCESS,\r\n\tUSER_REGISTER_FAILURE,\r\n\tUSER_RESET_PASSWORD_REQUEST,\r\n\tUSER_RESET_PASSWORD_SUCCESS,\r\n\tUSER_RESET_PASSWORD_FAILURE,\r\n\tUSER_EMAIL_VERIFICATION_REQUEST,\r\n\tUSER_EMAIL_VERIFICATION_SUCCESS,\r\n\tUSER_EMAIL_VERIFICATION_FAILURE,\r\n\tUSER_CONFIRM_REQUEST,\r\n\tUSER_CONFIRM_SUCCESS,\r\n\tUSER_CONFIRM_FAILURE,\r\n\tUSER_DETAILS_REQUEST,\r\n\tUSER_DETAILS_SUCCESS,\r\n\tUSER_DETAILS_FAILURE,\r\n\tUSER_DETAILS_RESET,\r\n\tUSER_PROFILE_UPDATE_REQUEST,\r\n\tUSER_PROFILE_UPDATE_SUCCESS,\r\n\tUSER_PROFILE_UPDATE_FAILURE,\r\n\tUSER_LIST_REQUEST,\r\n\tUSER_LIST_SUCCESS,\r\n\tUSER_LIST_FAILURE,\r\n\tUSER_DELETE_REQUEST,\r\n\tUSER_DELETE_SUCCESS,\r\n\tUSER_DELETE_FAILURE,\r\n\tUSER_UPDATE_REQUEST,\r\n\tUSER_UPDATE_SUCCESS,\r\n\tUSER_UPDATE_FAILURE,\r\n} from '../constants/userConstants';\r\nimport {\r\n\tORDER_CREATE_RESET,\r\n\tORDER_USER_LIST_RESET,\r\n} from '../constants/orderConstants';\r\nimport axios from 'axios';\r\n\r\n// login an user, can be a social login or a normal email verified login\r\nexport const loginUser = (email, password) => async (dispatch) => {\r\n\ttry {\r\n\t\tdispatch({ type: USER_LOGIN_REQUEST });\r\n\r\n\t\tconst config = {\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\tconst { data } = await axios.post(\r\n\t\t\t'/api/users/login',\r\n\t\t\t{ email, password },\r\n\t\t\tconfig\r\n\t\t);\r\n\r\n\t\tdispatch({\r\n\t\t\ttype: USER_LOGIN_SUCCESS,\r\n\t\t\tpayload: { ...data, isSocialLogin: false },\r\n\t\t});\r\n\t\tdispatch({\r\n\t\t\ttype: USER_LOGIN_REFRESH_SUCCESS,\r\n\t\t\tpayload: data.refreshToken,\r\n\t\t});\r\n\t\t// store the refresh token and the rest of the user info in the local storage\r\n\t\tlocalStorage.setItem('refreshToken', data.refreshToken);\r\n\t\tlocalStorage.setItem(\r\n\t\t\t'userInfo',\r\n\t\t\tJSON.stringify({ ...data, isSocialLogin: false })\r\n\t\t);\r\n\t\t// remove the variable that helps prompt the user that email is not verified, each time they login\r\n\t\tlocalStorage.removeItem('promptEmailVerfication');\r\n\t} catch (error) {\r\n\t\tdispatch({\r\n\t\t\ttype: USER_LOGIN_FAILURE,\r\n\t\t\tpayload:\r\n\t\t\t\terror.response && error.response.data.message\r\n\t\t\t\t\t? error.response.data.message\r\n\t\t\t\t\t: error.message,\r\n\t\t});\r\n\t}\r\n};\r\n\r\n// used for refreshing the access tokens when the user logs in using email and password\r\nexport const refreshLogin = (email) => async (dispatch, getState) => {\r\n\ttry {\r\n\t\tdispatch({ type: USER_LOGIN_REFRESH_REQUEST });\r\n\t\tconst {\r\n\t\t\tuserLogin: { userInfo },\r\n\t\t} = getState();\r\n\r\n\t\t// avoid this if social login\r\n\t\tif (userInfo.isSocialLogin) {\r\n\t\t\tdispatch({ type: USER_LOGIN_REFRESH_SUCCESS, payload: null });\r\n\t\t} else {\r\n\t\t\tconst config = {\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t},\r\n\t\t\t};\r\n\r\n\t\t\tconst { data } = await axios.post(\r\n\t\t\t\t'/api/users/refresh',\r\n\t\t\t\t{\r\n\t\t\t\t\temail,\r\n\t\t\t\t\ttoken: userInfo.refreshToken,\r\n\t\t\t\t},\r\n\t\t\t\tconfig\r\n\t\t\t);\r\n\r\n\t\t\tif (data.success) {\r\n\t\t\t\tdispatch({ type: USER_LOGIN_REFRESH_SUCCESS, payload: data });\r\n\t\t\t\tconst updatedUser = {\r\n\t\t\t\t\t...userInfo,\r\n\t\t\t\t\taccessToken: data.accessToken,\r\n\t\t\t\t\trefreshToken: userInfo.refreshToken,\r\n\t\t\t\t};\r\n\t\t\t\t// update the local storage\r\n\t\t\t\tlocalStorage.setItem('userInfo', JSON.stringify(updatedUser));\r\n\t\t\t\tdispatch({ type: USER_LOGIN_SUCCESS, payload: updatedUser });\r\n\t\t\t} else if (!data.success) {\r\n\t\t\t\t// set a variable in local storage which redirects to login page, if this refresh thing fails\r\n\t\t\t\tlocalStorage.removeItem('userInfo');\r\n\t\t\t\tlocalStorage.setItem('redirectLogin', 'true'); // after refresh token also expires, redirect to login page after loggin out the user\r\n\t\t\t\tdispatch({ type: USER_LOGOUT });\r\n\t\t\t}\r\n\t\t}\r\n\t} catch (error) {\r\n\t\tdispatch({\r\n\t\t\ttype: USER_LOGIN_REFRESH_FAILURE,\r\n\t\t\tpayload:\r\n\t\t\t\terror.response && error.response.data.message\r\n\t\t\t\t\t? error.response.data.message\r\n\t\t\t\t\t: error.message,\r\n\t\t});\r\n\t}\r\n};\r\n\r\n// logout by removing all local storage info\r\nexport const logoutUser = () => (dispatch) => {\r\n\tlocalStorage.removeItem('userInfo');\r\n\tlocalStorage.removeItem('redirectLogin');\r\n\tlocalStorage.removeItem('cartItems');\r\n\tdispatch({ type: USER_LOGOUT });\r\n\tdispatch({ type: USER_DETAILS_RESET });\r\n\tdispatch({ type: ORDER_CREATE_RESET });\r\n\tdispatch({ type: ORDER_USER_LIST_RESET });\r\n};\r\n\r\n// register a new user with the form for name, email, password\r\nexport const registerUser = (name, email, password) => async (dispatch) => {\r\n\ttry {\r\n\t\tdispatch({ type: USER_REGISTER_REQUEST });\r\n\t\tconst config = {\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\tconst { data } = await axios.post(\r\n\t\t\t'/api/users/',\r\n\t\t\t{ name, email, password },\r\n\t\t\tconfig\r\n\t\t);\r\n\r\n\t\tdispatch({ type: USER_REGISTER_SUCCESS, payload: data });\r\n\t} catch (error) {\r\n\t\tdispatch({\r\n\t\t\ttype: USER_REGISTER_FAILURE,\r\n\t\t\tpayload:\r\n\t\t\t\terror.response && error.response.data.message\r\n\t\t\t\t\t? error.response.data.message\r\n\t\t\t\t\t: error.message,\r\n\t\t});\r\n\t}\r\n};\r\n\r\n// send an email for verification of the newly registered account\r\nexport const sendVerficationEmail = (email) => async (dispatch) => {\r\n\ttry {\r\n\t\tdispatch({ type: USER_EMAIL_VERIFICATION_REQUEST });\r\n\t\tconst config = {\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\tconst { data } = await axios.post(\r\n\t\t\t'/api/users/confirm',\r\n\t\t\t{ email },\r\n\t\t\tconfig\r\n\t\t);\r\n\t\tdispatch({ type: USER_EMAIL_VERIFICATION_SUCCESS, payload: data });\r\n\t} catch (error) {\r\n\t\tdispatch({\r\n\t\t\ttype: USER_EMAIL_VERIFICATION_FAILURE,\r\n\t\t\tpayload:\r\n\t\t\t\terror.response && error.response.data.message\r\n\t\t\t\t\t? error.response.data.message\r\n\t\t\t\t\t: error.message,\r\n\t\t});\r\n\t}\r\n};\r\n\r\n// take the email token sent from the mail, and confirm the account once the link is clicked\r\nexport const confirmUser =\r\n\t(emailToken, alreadyLoggedIn = false) =>\r\n\tasync (dispatch, getState) => {\r\n\t\ttry {\r\n\t\t\tdispatch({ type: USER_CONFIRM_REQUEST });\r\n\t\t\tconst { data } = await axios.get(\r\n\t\t\t\t`/api/users/confirm/${emailToken}`\r\n\t\t\t);\r\n\r\n\t\t\t// remove variable meant to prompt the user for email verification\r\n\t\t\tlocalStorage.removeItem('promptEmailVerfication');\r\n\t\t\tdispatch({ type: USER_CONFIRM_SUCCESS, payload: true });\r\n\r\n\t\t\tif (alreadyLoggedIn) {\r\n\t\t\t\tdispatch({ type: USER_LOGIN_SUCCESS, payload: data });\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: USER_LOGIN_REFRESH_SUCCESS,\r\n\t\t\t\t\tpayload: data.refreshToken,\r\n\t\t\t\t});\r\n\t\t\t\tlocalStorage.setItem('refreshToken', data.refreshToken);\r\n\t\t\t\tlocalStorage.setItem('userInfo', JSON.stringify(data));\r\n\t\t\t}\r\n\r\n\t\t\tlocalStorage.removeItem('promptEmailVerfication');\r\n\t\t} catch (error) {\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: USER_CONFIRM_FAILURE,\r\n\t\t\t\tpayload:\r\n\t\t\t\t\terror.response && error.response.data.message\r\n\t\t\t\t\t\t? error.response.data.message\r\n\t\t\t\t\t\t: error.message,\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n// reset the user password and send one more verification email from the server\r\nexport const resetUserPassword =\r\n\t(passwordToken, password) => async (dispatch) => {\r\n\t\ttry {\r\n\t\t\tdispatch({ type: USER_RESET_PASSWORD_REQUEST });\r\n\r\n\t\t\t// make the api call to reset the password\r\n\t\t\tconst config = {\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t},\r\n\t\t\t};\r\n\r\n\t\t\tconst { data } = await axios.put(\r\n\t\t\t\t'/api/users/reset',\r\n\t\t\t\t{ passwordToken, password },\r\n\t\t\t\tconfig\r\n\t\t\t);\r\n\r\n\t\t\tdispatch({ type: USER_RESET_PASSWORD_SUCCESS, payload: data });\r\n\t\t} catch (error) {\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: USER_RESET_PASSWORD_FAILURE,\r\n\t\t\t\tpayload:\r\n\t\t\t\t\terror.response && error.response.data.message\r\n\t\t\t\t\t\t? error.response.data.message\r\n\t\t\t\t\t\t: error.message,\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n// get user details for profile page\r\nexport const getUserDetails = (id) => async (dispatch, getState) => {\r\n\ttry {\r\n\t\tdispatch({ type: USER_DETAILS_REQUEST });\r\n\r\n\t\tconst {\r\n\t\t\tuserLogin: { userInfo },\r\n\t\t} = getState();\r\n\r\n\t\tif (userInfo.isSocialLogin) {\r\n\t\t\tconst config = {\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t},\r\n\t\t\t};\r\n\r\n\t\t\tlet { data } = await axios.post(\r\n\t\t\t\t'/api/users/passport/data/',\r\n\t\t\t\t{ id },\r\n\t\t\t\tconfig\r\n\t\t\t);\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: USER_DETAILS_SUCCESS,\r\n\t\t\t\tpayload: { ...data, isSocialLogin: true },\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconst config = {\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t\tAuthorization: `Bearer ${userInfo.accessToken}`,\r\n\t\t\t\t},\r\n\t\t\t};\r\n\r\n\t\t\tconst { data } = await axios.get(`/api/users/${id}`, config);\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: USER_DETAILS_SUCCESS,\r\n\t\t\t\tpayload: { ...data, isSocialLogin: false },\r\n\t\t\t});\r\n\t\t}\r\n\t} catch (error) {\r\n\t\tdispatch({\r\n\t\t\ttype: USER_DETAILS_FAILURE,\r\n\t\t\tpayload:\r\n\t\t\t\terror.response && error.response.data.message\r\n\t\t\t\t\t? error.response.data.message\r\n\t\t\t\t\t: error.message,\r\n\t\t});\r\n\t}\r\n};\r\n\r\n// update details in the user profile page\r\nexport const updateUserProfile = (user) => async (dispatch, getState) => {\r\n\ttry {\r\n\t\tdispatch({ type: USER_PROFILE_UPDATE_REQUEST });\r\n\r\n\t\tconst {\r\n\t\t\tuserLogin: { userInfo },\r\n\t\t} = getState();\r\n\r\n\t\t// different headers are used when it is a social login, and when it is a std email login\r\n\t\tconst config = userInfo.isSocialLogin\r\n\t\t\t? {\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\tAuthorization: `SocialLogin ${userInfo.id}`,\r\n\t\t\t\t\t},\r\n\t\t\t  }\r\n\t\t\t: {\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\tAuthorization: `Bearer ${userInfo.accessToken}`,\r\n\t\t\t\t\t},\r\n\t\t\t  };\r\n\r\n\t\tconst isSocial = userInfo.isSocialLogin;\r\n\t\tconst { data } = await axios.put('/api/users/profile', user, config);\r\n\r\n\t\tdispatch({\r\n\t\t\ttype: USER_PROFILE_UPDATE_SUCCESS,\r\n\t\t\tpayload: { ...data, isSocialLogin: isSocial },\r\n\t\t});\r\n\r\n\t\t// login the user after updating the information\r\n\t\tdispatch({\r\n\t\t\ttype: USER_LOGIN_SUCCESS,\r\n\t\t\tpayload: { ...data, isSocialLogin: isSocial },\r\n\t\t});\r\n\r\n\t\tlocalStorage.setItem(\r\n\t\t\t'userInfo',\r\n\t\t\tJSON.stringify({ ...data, isSocialLogin: isSocial })\r\n\t\t);\r\n\t} catch (error) {\r\n\t\tdispatch({\r\n\t\t\ttype: USER_PROFILE_UPDATE_FAILURE,\r\n\t\t\tpayload:\r\n\t\t\t\terror.response && error.response.data.message\r\n\t\t\t\t\t? error.response.data.message\r\n\t\t\t\t\t: error.message,\r\n\t\t});\r\n\t}\r\n};\r\n\r\n// fetch a list of all users, for the admin panel view\r\nexport const listAllUsers =\r\n\t(pageNumber = '') =>\r\n\tasync (dispatch, getState) => {\r\n\t\ttry {\r\n\t\t\tdispatch({ type: USER_LIST_REQUEST });\r\n\r\n\t\t\tconst {\r\n\t\t\t\tuserLogin: { userInfo },\r\n\t\t\t} = getState();\r\n\r\n\t\t\t// different headers are used when it is a social login, and when it is a std email login\r\n\t\t\tconst config = userInfo.isSocialLogin\r\n\t\t\t\t? {\r\n\t\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t\tAuthorization: `SocialLogin ${userInfo.id}`,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t  }\r\n\t\t\t\t: {\r\n\t\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t\tAuthorization: `Bearer ${userInfo.accessToken}`,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t  };\r\n\r\n\t\t\tconst { data } = await axios.get(\r\n\t\t\t\t`/api/users?pageNumber=${pageNumber}`,\r\n\t\t\t\tconfig\r\n\t\t\t);\r\n\r\n\t\t\tdispatch({ type: USER_LIST_SUCCESS, payload: data });\r\n\t\t} catch (error) {\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: USER_LIST_FAILURE,\r\n\t\t\t\tpayload:\r\n\t\t\t\t\terror.response && error.response.data.message\r\n\t\t\t\t\t\t? error.response.data.message\r\n\t\t\t\t\t\t: error.message,\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n// delete the user from the admin panel view\r\nexport const deleteUser = (id) => async (dispatch, getState) => {\r\n\ttry {\r\n\t\tdispatch({ type: USER_DELETE_REQUEST });\r\n\r\n\t\tconst {\r\n\t\t\tuserLogin: { userInfo },\r\n\t\t} = getState();\r\n\r\n\t\t// different headers are used when it is a social login, and when it is a std email login\r\n\t\tconst config = userInfo.isSocialLogin\r\n\t\t\t? {\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\tAuthorization: `SocialLogin ${userInfo.id}`,\r\n\t\t\t\t\t},\r\n\t\t\t  }\r\n\t\t\t: {\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\tAuthorization: `Bearer ${userInfo.accessToken}`,\r\n\t\t\t\t\t},\r\n\t\t\t  };\r\n\r\n\t\tawait axios.delete(`/api/users/${id}`, config);\r\n\r\n\t\tdispatch({ type: USER_DELETE_SUCCESS });\r\n\t} catch (error) {\r\n\t\tdispatch({\r\n\t\t\ttype: USER_DELETE_FAILURE,\r\n\t\t\tpayload:\r\n\t\t\t\terror.response && error.response.data.message\r\n\t\t\t\t\t? error.response.data.message\r\n\t\t\t\t\t: error.message,\r\n\t\t});\r\n\t}\r\n};\r\n\r\n// update the user details\r\nexport const updateUser = (user) => async (dispatch, getState) => {\r\n\ttry {\r\n\t\tdispatch({ type: USER_UPDATE_REQUEST });\r\n\r\n\t\tconst {\r\n\t\t\tuserLogin: { userInfo },\r\n\t\t} = getState();\r\n\r\n\t\tconst config = userInfo.isSocialLogin\r\n\t\t\t? {\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t\t\tAuthorization: `SocialLogin ${userInfo.id}`,\r\n\t\t\t\t\t},\r\n\t\t\t  }\r\n\t\t\t: {\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t\t\tAuthorization: `Bearer ${userInfo.accessToken}`,\r\n\t\t\t\t\t},\r\n\t\t\t  };\r\n\r\n\t\tconst isSocial = userInfo.isSocialLogin;\r\n\t\tconst { data } = await axios.put(\r\n\t\t\t`/api/users/${user._id}`,\r\n\t\t\tuser,\r\n\t\t\tconfig\r\n\t\t);\r\n\r\n\t\tdispatch({ type: USER_UPDATE_SUCCESS });\r\n\t\tdispatch({\r\n\t\t\ttype: USER_DETAILS_SUCCESS,\r\n\t\t\tpayload: { ...data, isSocialLogin: isSocial },\r\n\t\t});\r\n\r\n\t\tif (data.id === userInfo.id) {\r\n\t\t\t// // login the user after updating the information\r\n\t\t\tconst newUserInfo = {\r\n\t\t\t\t...userInfo,\r\n\t\t\t\t...userInfo,\r\n\t\t\t\tid: data.id,\r\n\t\t\t\tname: data.name,\r\n\t\t\t\temail: data.email,\r\n\t\t\t\tisAdmin: data.isAdmin,\r\n\t\t\t\tisConfirmed: data.isConfirmed,\r\n\t\t\t};\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: USER_LOGIN_SUCCESS,\r\n\t\t\t\tpayload: newUserInfo,\r\n\t\t\t});\r\n\r\n\t\t\tlocalStorage.setItem('userInfo', JSON.stringify(newUserInfo));\r\n\t\t}\r\n\t} catch (error) {\r\n\t\tdispatch({\r\n\t\t\ttype: USER_UPDATE_FAILURE,\r\n\t\t\tpayload:\r\n\t\t\t\terror.response && error.response.data.message\r\n\t\t\t\t\t? error.response.data.message\r\n\t\t\t\t\t: error.message,\r\n\t\t});\r\n\t}\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}