{"ast":null,"code":"import _slicedToArray from\"C:/Users/qvuqv/OneDrive/Documents/UIT/ecom2/MERN-Ecommerce/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{useDispatch,useSelector}from'react-redux';import{Form,Button,FloatingLabel}from'react-bootstrap';import FormContainer from'../components/FormContainer';import CheckoutStatus from'../components/CheckoutStatus';import{saveShippingAddress}from'../actions/cartActions';import{refreshLogin,getUserDetails}from'../actions/userActions';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ShippingPage=function ShippingPage(_ref){var history=_ref.history;var dispatch=useDispatch();var cart=useSelector(function(state){return state.cart;});var cartItems=cart.cartItems,shippingAddress=cart.shippingAddress;var userLogin=useSelector(function(state){return state.userLogin;});var userInfo=userLogin.userInfo;var userDetails=useSelector(function(state){return state.userDetails;});var error=userDetails.error;var _useState=useState(shippingAddress.address),_useState2=_slicedToArray(_useState,2),address=_useState2[0],setAddress=_useState2[1];var _useState3=useState(shippingAddress.city),_useState4=_slicedToArray(_useState3,2),city=_useState4[0],setCity=_useState4[1];var _useState5=useState(shippingAddress.postalCode),_useState6=_slicedToArray(_useState5,2),postalCode=_useState6[0],setPostalCode=_useState6[1];var _useState7=useState(shippingAddress.country),_useState8=_slicedToArray(_useState7,2),country=_useState8[0],setCountry=_useState8[1];// fetch user details from the redux store\nuseEffect(function(){userInfo?userInfo.isSocialLogin?dispatch(getUserDetails(userInfo.id)):dispatch(getUserDetails('profile')):dispatch(getUserDetails('profile'));},[userInfo,dispatch]);// update access token to a new ine using the refresh tokens\nuseEffect(function(){if(error&&userInfo&&!userInfo.isSocialLogin){var user=JSON.parse(localStorage.getItem('userInfo'));user&&dispatch(refreshLogin(user.email));}},[error,dispatch,userInfo]);useEffect(function(){if(!(cartItems.length&&userInfo)){history.push('/');}},[cartItems,history,userInfo]);// save shipping address and move to payment screen\nvar handleSubmit=function handleSubmit(e){e.preventDefault();dispatch(saveShippingAddress({address:address,city:city,postalCode:postalCode,country:country}));history.push('/payment');};return/*#__PURE__*/_jsxs(FormContainer,{children:[/*#__PURE__*/_jsx(CheckoutStatus,{step1:true,step2:true}),/*#__PURE__*/_jsx(\"h1\",{children:\"Shipping Address\"}),/*#__PURE__*/_jsxs(Form,{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(Form.Group,{controlId:\"address\",children:/*#__PURE__*/_jsx(FloatingLabel,{controlId:\"addressinput\",label:\"Address\",className:\"mb-3\",children:/*#__PURE__*/_jsx(Form.Control,{size:\"lg\",placeholder:\"Enter address\",type:\"text\",value:address,required:true,onChange:function onChange(e){return setAddress(e.target.value);}})})}),/*#__PURE__*/_jsx(Form.Group,{controlId:\"city\",children:/*#__PURE__*/_jsx(FloatingLabel,{controlId:\"cityinput\",label:\"City\",className:\"mb-3\",children:/*#__PURE__*/_jsx(Form.Control,{size:\"lg\",placeholder:\"Enter City\",type:\"text\",value:city,required:true,onChange:function onChange(e){return setCity(e.target.value);}})})}),/*#__PURE__*/_jsx(Form.Group,{controlId:\"postalCode\",children:/*#__PURE__*/_jsx(FloatingLabel,{controlId:\"postalcodeinput\",label:\"Postal Code\",className:\"mb-3\",children:/*#__PURE__*/_jsx(Form.Control,{size:\"lg\",placeholder:\"Enter Postal Code\",type:\"text\",value:postalCode,required:true,onChange:function onChange(e){return setPostalCode(e.target.value);}})})}),/*#__PURE__*/_jsx(Form.Group,{controlId:\"country\",children:/*#__PURE__*/_jsx(FloatingLabel,{controlId:\"countryinput\",label:\"Country\",className:\"mb-3\",children:/*#__PURE__*/_jsx(Form.Control,{size:\"lg\",placeholder:\"Enter Country\",type:\"text\",value:country,required:true,onChange:function onChange(e){return setCountry(e.target.value);}})})}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex\",children:/*#__PURE__*/_jsx(Button,{type:\"submit\",className:\"ms-auto\",style:{padding:'0.5em 1em',width:'8rem'},children:\"Continue\"})})]})]});};export default ShippingPage;","map":{"version":3,"names":["React","useState","useEffect","useDispatch","useSelector","Form","Button","FloatingLabel","FormContainer","CheckoutStatus","saveShippingAddress","refreshLogin","getUserDetails","ShippingPage","history","dispatch","cart","state","cartItems","shippingAddress","userLogin","userInfo","userDetails","error","address","setAddress","city","setCity","postalCode","setPostalCode","country","setCountry","isSocialLogin","id","user","JSON","parse","localStorage","getItem","email","length","push","handleSubmit","e","preventDefault","target","value","padding","width"],"sources":["C:/Users/qvuqv/OneDrive/Documents/UIT/ecom2/MERN-Ecommerce/frontend/src/pages/ShippingPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Form, Button, FloatingLabel } from 'react-bootstrap';\r\nimport FormContainer from '../components/FormContainer';\r\nimport CheckoutStatus from '../components/CheckoutStatus';\r\nimport { saveShippingAddress } from '../actions/cartActions';\r\nimport { refreshLogin, getUserDetails } from '../actions/userActions';\r\n\r\nconst ShippingPage = ({ history }) => {\r\n\tconst dispatch = useDispatch();\r\n\r\n\tconst cart = useSelector((state) => state.cart);\r\n\tconst { cartItems, shippingAddress } = cart;\r\n\r\n\tconst userLogin = useSelector((state) => state.userLogin);\r\n\tconst { userInfo } = userLogin;\r\n\r\n\tconst userDetails = useSelector((state) => state.userDetails);\r\n\tconst { error } = userDetails;\r\n\r\n\tconst [address, setAddress] = useState(shippingAddress.address);\r\n\tconst [city, setCity] = useState(shippingAddress.city);\r\n\tconst [postalCode, setPostalCode] = useState(shippingAddress.postalCode);\r\n\tconst [country, setCountry] = useState(shippingAddress.country);\r\n\r\n\t// fetch user details from the redux store\r\n\tuseEffect(() => {\r\n\t\tuserInfo\r\n\t\t\t? userInfo.isSocialLogin\r\n\t\t\t\t? dispatch(getUserDetails(userInfo.id))\r\n\t\t\t\t: dispatch(getUserDetails('profile'))\r\n\t\t\t: dispatch(getUserDetails('profile'));\r\n\t}, [userInfo, dispatch]);\r\n\r\n\t// update access token to a new ine using the refresh tokens\r\n\tuseEffect(() => {\r\n\t\tif (error && userInfo && !userInfo.isSocialLogin) {\r\n\t\t\tconst user = JSON.parse(localStorage.getItem('userInfo'));\r\n\t\t\tuser && dispatch(refreshLogin(user.email));\r\n\t\t}\r\n\t}, [error, dispatch, userInfo]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!(cartItems.length && userInfo)) {\r\n\t\t\thistory.push('/');\r\n\t\t}\r\n\t}, [cartItems, history, userInfo]);\r\n\r\n\t// save shipping address and move to payment screen\r\n\tconst handleSubmit = (e) => {\r\n\t\te.preventDefault();\r\n\t\tdispatch(\r\n\t\t\tsaveShippingAddress({\r\n\t\t\t\taddress,\r\n\t\t\t\tcity,\r\n\t\t\t\tpostalCode,\r\n\t\t\t\tcountry,\r\n\t\t\t})\r\n\t\t);\r\n\t\thistory.push('/payment');\r\n\t};\r\n\r\n\treturn (\r\n\t\t<FormContainer>\r\n\t\t\t<CheckoutStatus step1 step2 />\r\n\t\t\t<h1>Shipping Address</h1>\r\n\t\t\t<Form onSubmit={handleSubmit}>\r\n\t\t\t\t<Form.Group controlId='address'>\r\n\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\tcontrolId='addressinput'\r\n\t\t\t\t\t\tlabel='Address'\r\n\t\t\t\t\t\tclassName='mb-3'>\r\n\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\tsize='lg'\r\n\t\t\t\t\t\t\tplaceholder='Enter address'\r\n\t\t\t\t\t\t\ttype='text'\r\n\t\t\t\t\t\t\tvalue={address}\r\n\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\tonChange={(e) => setAddress(e.target.value)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</FloatingLabel>\r\n\t\t\t\t</Form.Group>\r\n\t\t\t\t<Form.Group controlId='city'>\r\n\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\tcontrolId='cityinput'\r\n\t\t\t\t\t\tlabel='City'\r\n\t\t\t\t\t\tclassName='mb-3'>\r\n\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\tsize='lg'\r\n\t\t\t\t\t\t\tplaceholder='Enter City'\r\n\t\t\t\t\t\t\ttype='text'\r\n\t\t\t\t\t\t\tvalue={city}\r\n\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\tonChange={(e) => setCity(e.target.value)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</FloatingLabel>\r\n\t\t\t\t</Form.Group>\r\n\t\t\t\t<Form.Group controlId='postalCode'>\r\n\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\tcontrolId='postalcodeinput'\r\n\t\t\t\t\t\tlabel='Postal Code'\r\n\t\t\t\t\t\tclassName='mb-3'>\r\n\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\tsize='lg'\r\n\t\t\t\t\t\t\tplaceholder='Enter Postal Code'\r\n\t\t\t\t\t\t\ttype='text'\r\n\t\t\t\t\t\t\tvalue={postalCode}\r\n\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\tonChange={(e) => setPostalCode(e.target.value)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</FloatingLabel>\r\n\t\t\t\t</Form.Group>\r\n\t\t\t\t<Form.Group controlId='country'>\r\n\t\t\t\t\t<FloatingLabel\r\n\t\t\t\t\t\tcontrolId='countryinput'\r\n\t\t\t\t\t\tlabel='Country'\r\n\t\t\t\t\t\tclassName='mb-3'>\r\n\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\tsize='lg'\r\n\t\t\t\t\t\t\tplaceholder='Enter Country'\r\n\t\t\t\t\t\t\ttype='text'\r\n\t\t\t\t\t\t\tvalue={country}\r\n\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\tonChange={(e) => setCountry(e.target.value)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</FloatingLabel>\r\n\t\t\t\t</Form.Group>\r\n\t\t\t\t<div className='d-flex'>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\ttype='submit'\r\n\t\t\t\t\t\tclassName='ms-auto'\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tpadding: '0.5em 1em',\r\n\t\t\t\t\t\t\twidth: '8rem',\r\n\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\tContinue\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</div>\r\n\t\t\t</Form>\r\n\t\t</FormContainer>\r\n\t);\r\n};\r\n\r\nexport default ShippingPage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}